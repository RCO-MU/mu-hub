{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rco/Downloads/Repositories/mu-hub-1/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/rco/Downloads/Repositories/mu-hub-1/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/Users/rco/Downloads/Repositories/mu-hub-1/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/rco/Downloads/Repositories/mu-hub-1/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";/* ADAPTED FROM https://github.com/trananhtuat/react-drop-file-input */import*as React from'react';import axios from'axios';import'./DocumentUpload.css';import FormData from'form-data';import{useState}from'react';import ImageConfig from'../../utils/images';import uploadImg from'../../data/images/cloud-upload-regular-240.png';import Loader from'../Loader/Loader';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function DocumentUpload(_ref){var userInfo=_ref.userInfo,loading=_ref.loading,setLoading=_ref.setLoading;// **********************************************************************\n// STATE VARIABLES AND FUNCTIONS\n// **********************************************************************\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),fileList=_useState2[0],setFileList=_useState2[1];// **********************************************************************\n// HELPER FUNCTIONS (file list manipulation)\n// **********************************************************************\nvar onFileDrop=function onFileDrop(e){var newFile=e.target.files[0];if(newFile){var updatedList=[].concat(_toConsumableArray(fileList),[newFile]);setFileList(updatedList);}};function fileRemove(file){var updatedList=_toConsumableArray(fileList);updatedList.splice(fileList.indexOf(file),1);setFileList(updatedList);}// **********************************************************************\n// AXIOS FUNCTIONS (POST)\n// **********************************************************************\n/* Saves a file to database */function uploadFile(_x){return _uploadFile.apply(this,arguments);}// **********************************************************************\n// HANDLER FUNCTIONS\n// **********************************************************************\nfunction _uploadFile(){_uploadFile=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(file){var form,url,_yield$axios$post,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);_context.prev=1;// axios parameters\nform=new FormData();form.append('file',file);form.append('unixname',userInfo.unixname);// call axios\nurl='api/upload/';_context.next=8;return axios.post(url,form,{headers:form.getHeaders?form.getHeaders():{'Content-Type':'multipart/form-data'}});case 8:_yield$axios$post=_context.sent;data=_yield$axios$post.data;// print server resposnse\nconsole.log('response from server: ',data);fileRemove(file);return _context.abrupt(\"return\",data);case 15:_context.prev=15;_context.t0=_context[\"catch\"](1);console.error(_context.t0);return _context.abrupt(\"return\",null);case 19:_context.prev=19;setLoading(false);return _context.finish(19);case 22:case\"end\":return _context.stop();}}},_callee,null,[[1,15,19,22]]);}));return _uploadFile.apply(this,arguments);}function handleFileUpload(){fileList.forEach(function(file){return uploadFile(file);});}// **********************************************************************\n// PAGE RENDERING\n// **********************************************************************\n// loading\nif(loading){return/*#__PURE__*/_jsx(Loader,{});}return/*#__PURE__*/_jsxs(\"div\",{className:\"DocumentUpload\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"header\",children:\"Upload your documents here:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"drop-file-input\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"drop-file-input-label\",children:[/*#__PURE__*/_jsx(\"img\",{src:uploadImg,alt:\"\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Click OR Drag and Drop\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"file\",value:\"\",onChange:onFileDrop,encType:\"multipart/form-data\"})]}),fileList.length>0?/*#__PURE__*/_jsxs(\"div\",{className:\"drop-file-preview\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"drop-file-preview-title\",children:\"Files to upload\"}),fileList.map(function(item,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"drop-file-preview-item\",children:[/*#__PURE__*/_jsx(\"img\",{src:ImageConfig[item.type.split('/')[1]]||ImageConfig.default,alt:\"\"}),/*#__PURE__*/_jsx(\"div\",{className:\"drop-file-preview-item-info\",children:/*#__PURE__*/_jsx(\"p\",{children:item.name})}),/*#__PURE__*/_jsx(\"span\",{role:\"button\",tabIndex:0,onKeyDown:function onKeyDown(){},className:\"drop-file-preview-item-del\",onClick:function onClick(){return fileRemove(item);},style:{color:'red',fontSize:'x-large'},children:/*#__PURE__*/_jsx(\"b\",{children:\"x\"})})]},\"file\".concat(index+1));}),/*#__PURE__*/_jsx(\"input\",{className:\"action-button\",type:\"submit\",value:\"Upload\",onClick:handleFileUpload})]}):/*#__PURE__*/_jsx(\"h2\",{children:\"Todo: Display previously uploaded files or file upload error.\"})]});}","map":{"version":3,"names":["React","axios","FormData","useState","ImageConfig","uploadImg","Loader","DocumentUpload","userInfo","loading","setLoading","fileList","setFileList","onFileDrop","e","newFile","target","files","updatedList","fileRemove","file","splice","indexOf","uploadFile","form","append","unixname","url","post","headers","getHeaders","data","console","log","error","handleFileUpload","forEach","length","map","item","index","type","split","default","name","color","fontSize"],"sources":["/Users/rco/Downloads/Repositories/mu-hub-1/client/src/components/DocumentUpload/DocumentUpload.jsx"],"sourcesContent":["/* ADAPTED FROM https://github.com/trananhtuat/react-drop-file-input */\nimport * as React from 'react';\nimport axios from 'axios';\nimport './DocumentUpload.css';\nimport FormData from 'form-data';\nimport { useState } from 'react';\nimport ImageConfig from '../../utils/images';\nimport uploadImg from '../../data/images/cloud-upload-regular-240.png';\nimport Loader from '../Loader/Loader';\n\nexport default function DocumentUpload({ userInfo, loading, setLoading }) {\n  // **********************************************************************\n  // STATE VARIABLES AND FUNCTIONS\n  // **********************************************************************\n\n  const [fileList, setFileList] = useState([]);\n\n  // **********************************************************************\n  // HELPER FUNCTIONS (file list manipulation)\n  // **********************************************************************\n\n  const onFileDrop = (e) => {\n    const newFile = e.target.files[0];\n    if (newFile) {\n      const updatedList = [...fileList, newFile];\n      setFileList(updatedList);\n    }\n  };\n\n  function fileRemove(file) {\n    const updatedList = [...fileList];\n    updatedList.splice(fileList.indexOf(file), 1);\n    setFileList(updatedList);\n  }\n\n  // **********************************************************************\n  // AXIOS FUNCTIONS (POST)\n  // **********************************************************************\n\n  /* Saves a file to database */\n  async function uploadFile(file) {\n    setLoading(true);\n    try {\n      // axios parameters\n      const form = new FormData();\n      form.append('file', file);\n      form.append('unixname', userInfo.unixname);\n\n      // call axios\n      const url = 'api/upload/';\n      const { data } = await axios.post(url, form, {\n        headers: form.getHeaders ? form.getHeaders() : { 'Content-Type': 'multipart/form-data' },\n      });\n\n      // print server resposnse\n      console.log('response from server: ', data);\n\n      fileRemove(file);\n      return data;\n    } catch (err) {\n      console.error(err);\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // **********************************************************************\n  // HANDLER FUNCTIONS\n  // **********************************************************************\n\n  function handleFileUpload() {\n    fileList.forEach((file) => uploadFile(file));\n  }\n\n  // **********************************************************************\n  // PAGE RENDERING\n  // **********************************************************************\n\n  // loading\n  if (loading) {\n    return <Loader />;\n  }\n  return (\n    <div className=\"DocumentUpload\">\n      <h2 className=\"header\">\n        Upload your documents here:\n      </h2>\n      <div\n        className=\"drop-file-input\"\n      >\n        <div className=\"drop-file-input-label\">\n          <img src={uploadImg} alt=\"\" />\n          <p>Click OR Drag and Drop</p>\n        </div>\n        <input type=\"file\" name=\"file\" value=\"\" onChange={onFileDrop} encType=\"multipart/form-data\" />\n      </div>\n      {\n        fileList.length > 0 ? (\n          <div className=\"drop-file-preview\">\n            <p className=\"drop-file-preview-title\">\n              Files to upload\n            </p>\n            {\n              fileList.map((item, index) => (\n                <div key={`file${index + 1}`} className=\"drop-file-preview-item\">\n                  <img src={ImageConfig[item.type.split('/')[1]] || ImageConfig.default} alt=\"\" />\n                  <div className=\"drop-file-preview-item-info\">\n                    <p>{item.name}</p>\n                  </div>\n                  <span\n                    role=\"button\"\n                    tabIndex={0}\n                    onKeyDown={() => {}}\n                    className=\"drop-file-preview-item-del\"\n                    onClick={() => fileRemove(item)}\n                    style={{ color: 'red', fontSize: 'x-large' }}\n                  >\n                    <b>x</b>\n                  </span>\n                </div>\n              ))\n            }\n            <input\n              className=\"action-button\"\n              type=\"submit\"\n              value=\"Upload\"\n              onClick={handleFileUpload}\n            />\n          </div>\n        ) : <h2>Todo: Display previously uploaded files or file upload error.</h2>\n      }\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}