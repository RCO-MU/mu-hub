{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rco/Downloads/Repositories/mu-hub-1/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/rco/Downloads/Repositories/mu-hub-1/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/rco/Downloads/Repositories/mu-hub-1/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";/* eslint-disable no-console */import*as React from'react';import axios from'axios';import'./AccountUpdate.css';import{useState}from'react';import{useNavigate}from'react-router-dom';import Loader from'../Loader/Loader';import refreshPage from'../../utils/refreshPage';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function AccountUpdate(_ref){var userInfo=_ref.userInfo,loading=_ref.loading,setLoading=_ref.setLoading,setCookie=_ref.setCookie;// **********************************************************************\n// CONSTANTS/VARIABLES\n// **********************************************************************\nvar navigate=useNavigate();// **********************************************************************\n// STATE VARIABLES AND FUNCTIONS\n// **********************************************************************\nvar _useState=useState(''),_useState2=_slicedToArray(_useState,2),bio=_useState2[0],setBio=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isChanged=_useState4[0],setIsChanged=_useState4[1];// **********************************************************************\n// AXIOS FUNCTIONS (PUT)\n// **********************************************************************\n/*\n    Puts data through backend /api/intern endpoint using axios.\n    loading is true while this function runs and false otherwise.\n      (loading -> false is handled by page navigation in client function)\n    Updates intern info (bio) in database.\n    If an error occurs, the error is logged.\n  */function putInternUpdate(){return _putInternUpdate.apply(this,arguments);}/*\n    Deletes user account through api/user endpoint using axios.\n    loading is true while this function runs and false otherwise.\n      (loading -> false is handled by page navigation in client function)\n    Deletes all user account information from database.\n    If an error occurs, the error is logged.\n  */function _putInternUpdate(){_putInternUpdate=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var url;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setLoading(true);_context3.prev=1;url='api/intern'+\"?unixname=\".concat(userInfo.unixname)+\"&bio=\".concat(bio);_context3.next=5;return axios.put(url);case 5:_context3.next=10;break;case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](1);console.error(_context3.t0);case 10:case\"end\":return _context3.stop();}}},_callee3,null,[[1,7]]);}));return _putInternUpdate.apply(this,arguments);}function deleteAccount(){return _deleteAccount.apply(this,arguments);}// **********************************************************************\n// HANDLER FUNCTIONS\n// **********************************************************************\nfunction _deleteAccount(){_deleteAccount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){var url;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setLoading(true);_context4.prev=1;url='api/user'+\"?unixname=\".concat(userInfo.unixname);_context4.next=5;return axios.delete(url);case 5:_context4.next=10;break;case 7:_context4.prev=7;_context4.t0=_context4[\"catch\"](1);console.error(_context4.t0);case 10:case\"end\":return _context4.stop();}}},_callee4,null,[[1,7]]);}));return _deleteAccount.apply(this,arguments);}var handleOnInternUpdateSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return putInternUpdate();case 2:refreshPage();case 3:case\"end\":return _context.stop();}}},_callee);}));return function handleOnInternUpdateSubmit(){return _ref2.apply(this,arguments);};}();var handleDeleteAccount=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return deleteAccount();case 2:setCookie('data',{loggedIn:false,user:undefined});navigate('/');refreshPage();case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function handleDeleteAccount(){return _ref3.apply(this,arguments);};}();// **********************************************************************\n// PAGE RENDERING\n// **********************************************************************\n// loading\nif(loading){return/*#__PURE__*/_jsx(Loader,{});}// If user is an intern, allow bio editing. Else, no account edits can be made\n// Only display update button if bio has changed.\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"AccountUpdate\",children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-card\",children:[/*#__PURE__*/_jsx(\"p\",{id:\"name-update\",children:/*#__PURE__*/_jsx(\"b\",{children:\"\".concat(userInfo.user.name,\" (\").concat(userInfo.unixname,\")\")})}),userInfo.user.role==='intern'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"update-info\",children:/*#__PURE__*/_jsx(\"i\",{children:\"\\u2022 \".concat(userInfo.intern.division,\" (\").concat(userInfo.intern.startDate,\" Start)\")})}),/*#__PURE__*/_jsx(\"p\",{className:\"update-info\",children:/*#__PURE__*/_jsx(\"i\",{children:\"\\u2022 Lives in \".concat(userInfo.intern.residence)})}),/*#__PURE__*/_jsx(\"p\",{className:\"update-info\",children:/*#__PURE__*/_jsx(\"i\",{children:\"\\u2022 Goes to \".concat(userInfo.intern.college)})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"p\",{className:\"update-info\",children:/*#__PURE__*/_jsx(\"b\",{children:\"Bio:\"})}),/*#__PURE__*/_jsx(\"textarea\",{id:\"bio\",className:\"input-field update text\",placeholder:\"Tell us about yourself!\",name:\"bio\",defaultValue:userInfo.intern.bio,onChange:function onChange(e){setBio(e.target.value);setIsChanged(true);}}),/*#__PURE__*/_jsx(\"br\",{}),isChanged?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{className:\"action-button\",type:\"submit\",value:\"Update\",onClick:handleOnInternUpdateSubmit}),/*#__PURE__*/_jsx(\"br\",{})]}):null]}):/*#__PURE__*/_jsx(\"h2\",{children:\"Admins cannot edit their account information.\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"action-button\",type:\"button\",onClick:function onClick(){return navigate('/');},children:\"Return Home\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{className:\"action-button delete\",type:\"button\",onClick:handleDeleteAccount,children:\"Delete Account\"})]});}","map":{"version":3,"names":["React","axios","useState","useNavigate","Loader","refreshPage","AccountUpdate","userInfo","loading","setLoading","setCookie","navigate","bio","setBio","isChanged","setIsChanged","putInternUpdate","url","unixname","put","console","error","deleteAccount","delete","handleOnInternUpdateSubmit","handleDeleteAccount","loggedIn","user","undefined","name","role","intern","division","startDate","residence","college","e","target","value"],"sources":["/Users/rco/Downloads/Repositories/mu-hub-1/client/src/components/AccountUpdate/AccountUpdate.jsx"],"sourcesContent":["/* eslint-disable no-console */\nimport * as React from 'react';\nimport axios from 'axios';\nimport './AccountUpdate.css';\nimport { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport Loader from '../Loader/Loader';\nimport refreshPage from '../../utils/refreshPage';\n\nexport default function AccountUpdate({\n  userInfo, loading, setLoading, setCookie,\n}) {\n  // **********************************************************************\n  // CONSTANTS/VARIABLES\n  // **********************************************************************\n\n  const navigate = useNavigate();\n\n  // **********************************************************************\n  // STATE VARIABLES AND FUNCTIONS\n  // **********************************************************************\n\n  const [bio, setBio] = useState('');\n  const [isChanged, setIsChanged] = useState(false);\n\n  // **********************************************************************\n  // AXIOS FUNCTIONS (PUT)\n  // **********************************************************************\n\n  /*\n    Puts data through backend /api/intern endpoint using axios.\n    loading is true while this function runs and false otherwise.\n      (loading -> false is handled by page navigation in client function)\n    Updates intern info (bio) in database.\n    If an error occurs, the error is logged.\n  */\n  async function putInternUpdate() {\n    setLoading(true);\n    try {\n      const url = 'api/intern'\n      + `?unixname=${userInfo.unixname}`\n      + `&bio=${bio}`;\n      await axios.put(url);\n    } catch (err) {\n      console.error(err);\n    }\n  }\n\n  /*\n    Deletes user account through api/user endpoint using axios.\n    loading is true while this function runs and false otherwise.\n      (loading -> false is handled by page navigation in client function)\n    Deletes all user account information from database.\n    If an error occurs, the error is logged.\n  */\n  async function deleteAccount() {\n    setLoading(true);\n    try {\n      const url = 'api/user'\n        + `?unixname=${userInfo.unixname}`;\n      await axios.delete(url);\n    } catch (err) {\n      console.error(err);\n    }\n  }\n\n  // **********************************************************************\n  // HANDLER FUNCTIONS\n  // **********************************************************************\n\n  const handleOnInternUpdateSubmit = async () => {\n    await putInternUpdate();\n    refreshPage();\n  };\n\n  const handleDeleteAccount = async () => {\n    await deleteAccount();\n    setCookie('data', {\n      loggedIn: false,\n      user: undefined,\n    });\n    navigate('/');\n    refreshPage();\n  };\n\n  // **********************************************************************\n  // PAGE RENDERING\n  // **********************************************************************\n\n  // loading\n  if (loading) {\n    return <Loader />;\n  }\n  // If user is an intern, allow bio editing. Else, no account edits can be made\n  // Only display update button if bio has changed.\n  return (\n    <div className=\"AccountUpdate\">\n      <br />\n      <div className=\"user-card\">\n        <p id=\"name-update\"><b>{`${userInfo.user.name} (${userInfo.unixname})`}</b></p>\n        {userInfo.user.role === 'intern' ? (\n          <>\n            <p className=\"update-info\"><i>{`• ${userInfo.intern.division} (${userInfo.intern.startDate} Start)`}</i></p>\n            <p className=\"update-info\"><i>{`• Lives in ${userInfo.intern.residence}`}</i></p>\n            <p className=\"update-info\"><i>{`• Goes to ${userInfo.intern.college}`}</i></p>\n            <br />\n            <p className=\"update-info\"><b>Bio:</b></p>\n            <textarea\n              id=\"bio\"\n              className=\"input-field update text\"\n              placeholder=\"Tell us about yourself!\"\n              name=\"bio\"\n              defaultValue={userInfo.intern.bio}\n              onChange={(e) => { setBio(e.target.value); setIsChanged(true); }}\n            />\n            <br />\n            {isChanged ? (\n              <>\n                <input\n                  className=\"action-button\"\n                  type=\"submit\"\n                  value=\"Update\"\n                  onClick={handleOnInternUpdateSubmit}\n                />\n                <br />\n              </>\n            ) : null}\n          </>\n        ) : (<h2>Admins cannot edit their account information.</h2>)}\n      </div>\n      <button\n        className=\"action-button\"\n        type=\"button\"\n        onClick={() => navigate('/')}\n      >\n        Return Home\n      </button>\n      <br />\n      <button\n        className=\"action-button delete\"\n        type=\"button\"\n        onClick={handleDeleteAccount}\n      >\n        Delete Account\n      </button>\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}