{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rco/Downloads/Repositories/mu-hub-1/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/rco/Downloads/Repositories/mu-hub-1/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/rco/Downloads/Repositories/mu-hub-1/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import*as React from'react';import axios from'axios';import{useState,useEffect}from'react';import{Routes,Route}from'react-router-dom';import{useCookies}from'react-cookie';import Home from'../Home/Home';import Banner from'../Banner/Banner';import Navbar from'../Navbar/Navbar';import Loader from'../Loader/Loader';import NotFound from'../NotFound/NotFound';import Login from'../Login/Login';import AccountCreate from'../AccountCreate/AccountCreate';import InternCreate from'../InternCreate/InternCreate';import AccountUpdate from'../AccountUpdate/AccountUpdate';import DocumentUpload from'../DocumentUpload/DocumentUpload';import'./App.css';import Sidebar from'../Sidebar/Sidebar';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function App(){// **********************************************************************\n// CONSTANTS & VARIABLES\n// **********************************************************************\nvar _useCookies=useCookies(['cookie-name']),_useCookies2=_slicedToArray(_useCookies,2),cookies=_useCookies2[0],setCookie=_useCookies2[1];// **********************************************************************\n// STATE VARIABLES AND FUNCTIONS\n// **********************************************************************\nvar _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loggedIn=_useState4[0],setLoggedIn=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),userInfo=_useState6[0],setUserInfo=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),hasAccount=_useState8[0],setHasAccount=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isIntern=_useState10[0],setIsIntern=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),accountComplete=_useState12[0],setAccountComplete=_useState12[1];// **********************************************************************\n// AXIOS FUNCTIONS (GET)\n// **********************************************************************\n/*\n    Retrieves data from backend /api/user endpoint using axios.\n    loading is true while this function runs and false otherwise.\n    If response is valid, userInfo is set to the data that was fetched.\n    If an error occurs, the error is logged.\n  */function fetchUserInfo(_x){return _fetchUserInfo.apply(this,arguments);}// **********************************************************************\n// USE EFFECT\n// **********************************************************************\n/*\n    Fetches userInfo to be used throughout the application\n    Also assesses current user account state, several possibilities:\n    - User has never logged into the site, thus no cookies\n    - User has logged in but has no account info. (WILL BE REPLACED WITH AUTOMATIC SSO)\n    - User is a logged-in intern with no intern info.\n    - User has logged in and all info is complete.\n  */function _fetchUserInfo(){_fetchUserInfo=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(username){var url,_yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setLoading(true);_context2.prev=1;url='api/user'+\"?unixname=\".concat(username);_context2.next=5;return axios.get(url);case 5:_yield$axios$get=_context2.sent;data=_yield$axios$get.data;setUserInfo(data);console.log(data);return _context2.abrupt(\"return\",data);case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](1);console.error(_context2.t0);return _context2.abrupt(\"return\",null);case 16:_context2.prev=16;setLoading(false);return _context2.finish(16);case 19:case\"end\":return _context2.stop();}}},_callee2,null,[[1,12,16,19]]);}));return _fetchUserInfo.apply(this,arguments);}useEffect(function(){function effect(){return _effect.apply(this,arguments);}// call defined function\nfunction _effect(){_effect=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var user,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// get cookie information\nif(cookies.data!==undefined){setLoggedIn(cookies.data.loggedIn);user=cookies.data.user;}// if current user is defined, fetch user info, set state vars accordingly\nif(!user){_context.next=7;break;}_context.next=4;return fetchUserInfo(user);case 4:data=_context.sent;if(data.user){setHasAccount(true);if(data.user.role==='intern'){setIsIntern(true);}else{setAccountComplete(true);}}if(data.intern){setAccountComplete(true);}case 7:setLoading(false);case 8:case\"end\":return _context.stop();}}},_callee);}));return _effect.apply(this,arguments);}effect();},[]);// **********************************************************************\n// PAGE RENDERING\n// **********************************************************************\n// loading\nif(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsx(Loader,{})});}// figure out which element is rendered for \"/\" endpoint\nvar mainElement=function mainElement(){// if user has never logged in, or has logged out\nif(loggedIn===undefined||loggedIn===false){return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(Banner,{}),/*#__PURE__*/_jsx(Login,{userInfo:userInfo,loading:loading,setLoading:setLoading,setCookie:setCookie})]});}// if user has no account info\nif(!hasAccount){return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(Banner,{}),/*#__PURE__*/_jsx(AccountCreate,{loading:loading,setLoading:setLoading,setCookie:setCookie})]});}// if user is an intern with no intern info\nif(isIntern&&!accountComplete){return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(Banner,{}),/*#__PURE__*/_jsx(InternCreate,{userInfo:userInfo,loading:loading,setLoading:setLoading,setCookie:setCookie})]});}// else, logged in with all account info\nreturn/*#__PURE__*/_jsx(Home,{userInfo:userInfo,loading:loading});};// display navbar and sidebar if user is logged in and account is complete.\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsxs(\"main\",{children:[accountComplete&&loggedIn?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Sidebar,{userInfo:userInfo,setLoading:setLoading,setCookie:setCookie}),/*#__PURE__*/_jsx(Navbar,{})]}):null,/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:mainElement()}),/*#__PURE__*/_jsx(Route,{path:\"/account_update\",element:accountComplete&&loggedIn?/*#__PURE__*/_jsx(AccountUpdate,{userInfo:userInfo,loading:loading,setLoading:setLoading,setCookie:setCookie}):/*#__PURE__*/_jsx(NotFound,{loggedIn:loggedIn&&accountComplete})}),/*#__PURE__*/_jsx(Route,{path:\"/document_upload\",element:accountComplete&&loggedIn?/*#__PURE__*/_jsx(DocumentUpload,{userInfo:userInfo,loading:loading,setLoading:setLoading}):/*#__PURE__*/_jsx(NotFound,{loggedIn:loggedIn&&accountComplete})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(NotFound,{loggedIn:loggedIn&&accountComplete})})]})]})});}// TODO: Create a footer (login only maybe?)","map":{"version":3,"names":["React","axios","useState","useEffect","Routes","Route","useCookies","Home","Banner","Navbar","Loader","NotFound","Login","AccountCreate","InternCreate","AccountUpdate","DocumentUpload","Sidebar","App","cookies","setCookie","loading","setLoading","loggedIn","setLoggedIn","userInfo","setUserInfo","hasAccount","setHasAccount","isIntern","setIsIntern","accountComplete","setAccountComplete","fetchUserInfo","username","url","get","data","console","log","error","effect","undefined","user","role","intern","mainElement"],"sources":["/Users/rco/Downloads/Repositories/mu-hub-1/client/src/components/App/App.jsx"],"sourcesContent":["import * as React from 'react';\nimport axios from 'axios';\nimport { useState, useEffect } from 'react';\nimport { Routes, Route } from 'react-router-dom';\nimport { useCookies } from 'react-cookie';\nimport Home from '../Home/Home';\nimport Banner from '../Banner/Banner';\nimport Navbar from '../Navbar/Navbar';\nimport Loader from '../Loader/Loader';\nimport NotFound from '../NotFound/NotFound';\nimport Login from '../Login/Login';\nimport AccountCreate from '../AccountCreate/AccountCreate';\nimport InternCreate from '../InternCreate/InternCreate';\nimport AccountUpdate from '../AccountUpdate/AccountUpdate';\nimport DocumentUpload from '../DocumentUpload/DocumentUpload';\nimport './App.css';\nimport Sidebar from '../Sidebar/Sidebar';\n\nexport default function App() {\n  // **********************************************************************\n  // CONSTANTS & VARIABLES\n  // **********************************************************************\n\n  const [cookies, setCookie] = useCookies(['cookie-name']);\n\n  // **********************************************************************\n  // STATE VARIABLES AND FUNCTIONS\n  // **********************************************************************\n\n  const [loading, setLoading] = useState(true);\n  const [loggedIn, setLoggedIn] = useState(false);\n  const [userInfo, setUserInfo] = useState({});\n  const [hasAccount, setHasAccount] = useState(false);\n  const [isIntern, setIsIntern] = useState(false);\n  const [accountComplete, setAccountComplete] = useState(false);\n\n  // **********************************************************************\n  // AXIOS FUNCTIONS (GET)\n  // **********************************************************************\n\n  /*\n    Retrieves data from backend /api/user endpoint using axios.\n    loading is true while this function runs and false otherwise.\n    If response is valid, userInfo is set to the data that was fetched.\n    If an error occurs, the error is logged.\n  */\n  async function fetchUserInfo(username) {\n    setLoading(true);\n    try {\n      const url = 'api/user'\n      + `?unixname=${username}`;\n      const { data } = await axios.get(url);\n      setUserInfo(data);\n      console.log(data);\n      return data;\n    } catch (err) {\n      console.error(err);\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // **********************************************************************\n  // USE EFFECT\n  // **********************************************************************\n\n  /*\n    Fetches userInfo to be used throughout the application\n    Also assesses current user account state, several possibilities:\n    - User has never logged into the site, thus no cookies\n    - User has logged in but has no account info. (WILL BE REPLACED WITH AUTOMATIC SSO)\n    - User is a logged-in intern with no intern info.\n    - User has logged in and all info is complete.\n  */\n  useEffect(() => {\n    async function effect() {\n      // get cookie information\n      let user;\n      if (cookies.data !== undefined) {\n        setLoggedIn(cookies.data.loggedIn);\n        user = cookies.data.user;\n      }\n      // if current user is defined, fetch user info, set state vars accordingly\n      if (user) {\n        const data = await fetchUserInfo(user);\n        if (data.user) {\n          setHasAccount(true);\n          if (data.user.role === 'intern') {\n            setIsIntern(true);\n          } else {\n            setAccountComplete(true);\n          }\n        }\n        if (data.intern) {\n          setAccountComplete(true);\n        }\n      }\n      setLoading(false);\n    }\n    // call defined function\n    effect();\n  }, []);\n\n  // **********************************************************************\n  // PAGE RENDERING\n  // **********************************************************************\n\n  // loading\n  if (loading) {\n    return (\n      <div className=\"App\">\n        <Loader />\n      </div>\n    );\n  }\n\n  // figure out which element is rendered for \"/\" endpoint\n  const mainElement = () => {\n    // if user has never logged in, or has logged out\n    if (loggedIn === undefined || loggedIn === false) {\n      return (\n        <div className=\"App\">\n          <Banner />\n          <Login\n            userInfo={userInfo}\n            loading={loading}\n            setLoading={setLoading}\n            setCookie={setCookie}\n          />\n        </div>\n      );\n    }\n    // if user has no account info\n    if (!hasAccount) {\n      return (\n        <div className=\"App\">\n          <Banner />\n          <AccountCreate\n            loading={loading}\n            setLoading={setLoading}\n            setCookie={setCookie}\n          />\n        </div>\n      );\n    }\n    // if user is an intern with no intern info\n    if (isIntern && !accountComplete) {\n      return (\n        <div className=\"App\">\n          <Banner />\n          <InternCreate\n            userInfo={userInfo}\n            loading={loading}\n            setLoading={setLoading}\n            setCookie={setCookie}\n          />\n        </div>\n      );\n    }\n    // else, logged in with all account info\n    return (\n      <Home\n        userInfo={userInfo}\n        loading={loading}\n      />\n    );\n  };\n\n  // display navbar and sidebar if user is logged in and account is complete.\n  return (\n    <div className=\"App\">\n      <main>\n        {accountComplete && loggedIn ? (\n          <>\n            <Sidebar\n              userInfo={userInfo}\n              setLoading={setLoading}\n              setCookie={setCookie}\n            />\n            <Navbar />\n          </>\n        ) : null}\n        <Routes>\n          <Route\n            path=\"/\"\n            element={(\n            mainElement()\n)}\n          />\n          <Route\n            path=\"/account_update\"\n            element={accountComplete && loggedIn ? (\n              <AccountUpdate\n                userInfo={userInfo}\n                loading={loading}\n                setLoading={setLoading}\n                setCookie={setCookie}\n              />\n            ) : <NotFound loggedIn={loggedIn && accountComplete} />}\n          />\n          <Route\n            path=\"/document_upload\"\n            element={accountComplete && loggedIn ? (\n              <DocumentUpload\n                userInfo={userInfo}\n                loading={loading}\n                setLoading={setLoading}\n              />\n            ) : <NotFound loggedIn={loggedIn && accountComplete} />}\n          />\n          <Route\n            path=\"*\"\n            element={<NotFound loggedIn={loggedIn && accountComplete} />}\n          />\n        </Routes>\n      </main>\n    </div>\n  );\n}\n\n// TODO: Create a footer (login only maybe?)\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}